<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>{% block title %}{{ site.name }}{% endblock %}</title>
    
    {# Favicon #}
    {% if site_icon_url %}
    <link rel="icon" href="{{ site_icon_url }}" sizes="32x32" />
    <link rel="icon" href="{{ site_icon_url }}" sizes="192x192" />
    <link rel="apple-touch-icon" href="{{ site_icon_url }}" />
    {% endif %}
    
    {# Global Styles - Always loaded #}
    <link rel="stylesheet" href="{{ theme_uri }}/assets/global/styles.css" />
    
    {# Page-specific styles #}
    {% block styles %}{% endblock %}
    
    {# Additional head content (inline styles, etc.) #}
    {% block head_extra %}{% endblock %}
</head>
  <body class="{% block body_class %}learnsimply-homepage-body{% endblock %}">
    
    {# Header #}
	{% block header %}
		{% include 'components/header.twig' %}
	{% endblock %}

    {# Main Content #}
    <main {% block main_attributes %}{% endblock %}>
		{% block content %}{% endblock %}
	</main>

    {# Footer #}
	{% block footer %}
		{% include 'components/footer.twig' %}
	{% endblock %}

    {# Additional body content (buttons, etc.) #}
    {% block body_extra %}{% endblock %}

    {# Global Scripts - Always loaded #}
    <script src="{{ theme_uri }}/assets/global/script.js"></script>
    
    {# Cart URL for JavaScript redirects #}
    {% if cart_url %}
    <script>
        window.learnsimplyCartUrl = '{{ cart_url }}';
        
        // Force redirect to cart if add-to-cart parameter is present
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const addToCart = urlParams.get('add-to-cart');
            if (addToCart && window.learnsimplyCartUrl) {
                // Check if we're not already on cart page
                if (!window.location.pathname.includes('/cart')) {
                    // Redirect to clean cart URL without query parameters
                    const cleanCartUrl = window.learnsimplyCartUrl.split('?')[0];
                    window.location.href = cleanCartUrl;
                } else {
                    // If already on cart page, remove add-to-cart parameter to prevent loops
                    const cleanCartUrl = window.learnsimplyCartUrl.split('?')[0];
                    if (window.location.href !== cleanCartUrl) {
                        window.location.href = cleanCartUrl;
                    }
                }
            }
        })();
    </script>
    {% endif %}
    
    {# Page-specific scripts #}
    {% block scripts %}{% endblock %}
</body>
</html>
